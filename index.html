<html lang="en">
<head>
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1" name="viewport" />
<title>ECI Creation Shop- Online Clothing Shopping (Rwanda)</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet" />
<style>
:root {
  --primary-color: #1e40af; /* Indigo-800 */
  --secondary-color: #10b981; /* Emerald-500 */
  --text-primary: #111827; /* Gray-900 */
  --text-secondary: #6b7280; /* Gray-500 */
  --background-light: #f9fafb; /* Gray-50 */
  --background-dark: #111827; /* Gray-900 */
  --link-color: #2563eb; /* Blue-600 */
  --link-hover-color: #1d4ed8; /* Blue-700 */
  --error-color: #ef4444; /* Red-500 */
  --success-color: #10b981; /* Emerald-500 */
}
body {
  font-family: "Montserrat", sans-serif;
  box-sizing: border-box;
  margin: 0;
  background-color: var(--background-light);
  color: var(--text-primary);
  scroll-behavior: smooth;
}
*, *::before, *::after {
  box-sizing: inherit;
}
/* Button border animation */
.big-border-button a {
  transition: all 0.3s;
  border: 2px solid transparent;
  display: inline-block;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  color: white;
  text-decoration: none;
  font-weight: 600;
  cursor: pointer;
}
.big-border-button a:hover {
  border-color: #fff;
  background-color: rgba(255, 255, 255, 0.1);
}
/* Image hover effect */
.thumb img {
  transition: transform 0.3s ease;
  border-radius: 0.375rem;
  display: block;
  width: 100%;
  height: 100%;
  object-fit: cover;
  will-change: transform;
}
.thumb:hover img, .thumb:focus-within img {
  transform: scale(1.05);
}
/* Modal animations */
.popupContainer {
  animation: fadeIn 0.3s ease-in-out forwards;
}
.modal_close:hover {
  transform: rotate(90deg);
  transition: transform 0.3s;
}
/* Pricing card lift effect */
.pricing-item {
  transition: transform 0.3s, box-shadow 0.3s;
}
.pricing-item:hover {
  transform: translateY(-10px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}
/* FadeIn keyframes */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
/* Header */
header {
  background-color: var(--primary-color);
}
header a, header button, nav a, nav button {
  color: white;
}
nav a:hover, nav a:focus, nav button:hover, nav button:focus {
  text-decoration: underline;
  outline: none;
}
#mobile-menu {
  background-color: var(--primary-color);
  border-top-color: rgba(30, 64, 175, 0.3);
}
#mobile-menu a:hover, #mobile-menu a:focus, #mobile-menu button:hover, #mobile-menu button:focus {
  background-color: #1e3a8a; /* Indigo-900 */
  outline: none;
}
/* Focus rings */
input:focus, select:focus, button:focus, textarea:focus {
  outline: none;
  box-shadow: 0 0 0 3px var(--link-hover-color);
  border-color: var(--link-hover-color);
}
/* Inputs and selects */
input, select, textarea {
  border-color: #d1d5db; /* Gray-300 */
  color: var(--text-primary);
  background-color: white;
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
/* Product cards */
.add-to-cart-btn {
  background-color: var(--primary-color);
  color: white;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}
.add-to-cart-btn:hover, .add-to-cart-btn:focus {
  background-color: var(--link-hover-color);
  outline: none;
  box-shadow: 0 0 0 3px var(--link-hover-color);
}
/* Product detail modal */
#productDetailPrice {
  color: var(--primary-color);
}
#addToCartDetailBtn {
  background-color: var(--primary-color);
  color: white;
  transition: background-color 0.3s ease;
}
#addToCartDetailBtn:hover, #addToCartDetailBtn:focus {
  background-color: var(--link-hover-color);
  outline: none;
}
/* Cart sidebar */
#cartSidebar h2 {
  color: var(--primary-color);
}
#closeCartBtn:hover, #closeCartBtn:focus {
  color: var(--primary-color);
  outline: none;
}
#cartItems input[type="number"]:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px var(--link-hover-color);
  outline: none;
}
/* Checkout modal */
#checkoutTitle {
  color: var(--primary-color);
}
#closeCheckoutBtn:hover, #closeCheckoutBtn:focus {
  color: var(--primary-color);
  outline: none;
}
#checkoutForm input:focus, #checkoutForm textarea:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px var(--link-hover-color);
  outline: none;
}
#checkoutForm button[type="submit"] {
  background-color: var(--primary-color);
  color: white;
  transition: background-color 0.3s ease;
}
#checkoutForm button[type="submit"]:hover, #checkoutForm button[type="submit"]:focus {
  background-color: var(--link-hover-color);
  outline: none;
}
/* Scrollbar for chat and cart */
#chatbotMessages::-webkit-scrollbar, #cartItems::-webkit-scrollbar, #checkoutSummary::-webkit-scrollbar {
  width: 8px;
}
#chatbotMessages::-webkit-scrollbar-thumb, #cartItems::-webkit-scrollbar-thumb, #checkoutSummary::-webkit-scrollbar-thumb {
  background-color: rgba(30, 64, 175, 0.5);
  border-radius: 4px;
}
#chatbotMessages::-webkit-scrollbar-track, #cartItems::-webkit-scrollbar-track, #checkoutSummary::-webkit-scrollbar-track {
  background-color: #f9fafb;
}
/* Responsive fixes */
@media (max-width: 768px) {
  #cartSidebar {
    width: 100vw;
    max-width: 320px;
  }
  #chatbot {
    width: 90vw;
    max-width: 320px;
  }
}
/* Footer styling */
footer {
  background-color: var(--primary-color);
  color: white;
  padding: 2rem 1rem;
}
.footer-container {
  max-width: 7xl;
  margin-left: auto;
  margin-right: auto;
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  justify-content: space-between;
}
.footer-section {
  flex: 1 1 250px;
  min-width: 250px;
}
.footer-logo {
  display: flex;
  align-items: center;
  font-weight: 600;
  font-size: 1.25rem;
  margin-bottom: 1rem;
}
.footer-logo div {
  background-color: white;
  color: var(--primary-color);
  font-weight: 700;
  font-size: 1.5rem;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 9999px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 0.75rem;
  user-select: none;
}
.footer-section h3 {
  font-weight: 600;
  font-size: 1.125rem;
  margin-bottom: 0.75rem;
}
.footer-section p, .footer-section a {
  font-size: 0.875rem;
  color: white;
  text-decoration: none;
  display: block;
  margin-bottom: 0.5rem;
}
.footer-section a:hover, .footer-section a:focus {
  text-decoration: underline;
  outline: none;
}
/* Contact form styling */
#contact form {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}
#contact input, #contact textarea {
  padding: 0.5rem 0.75rem;
  border-radius: 0.375rem;
  border: none;
  font-size: 0.875rem;
  font-family: inherit;
  resize: vertical;
}
#contact input:focus, #contact textarea:focus {
  outline: 2px solid var(--secondary-color);
  outline-offset: 2px;
}
#contact button {
  background-color: var(--secondary-color);
  color: white;
  font-weight: 600;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s ease;
  font-size: 1rem;
}
#contact button:hover, #contact button:focus {
  background-color: #059669; /* Emerald-600 */
  outline: none;
}
/* Chatbot messages styling */
.chatbot-message.user {
  background-color: #d1fae5; /* Emerald-100 */
  color: #065f46; /* Emerald-800 */
  padding: 0.5rem 1rem;
  border-radius: 1rem 1rem 0.25rem 1rem;
  margin-bottom: 0.5rem;
  max-width: 75%;
  align-self: flex-end;
  word-wrap: break-word;
}
.chatbot-message.bot {
  background-color: #e0e7ff; /* Indigo-100 */
  color: #3730a3; /* Indigo-800 */
  padding: 0.5rem 1rem;
  border-radius: 1rem 1rem 1rem 0.25rem;
  margin-bottom: 0.5rem;
  max-width: 75%;
  align-self: flex-start;
  word-wrap: break-word;
}
/* Product image fixed height */
.product-image {
  height: 280px !important; /* smaller height for better layout */
  object-fit: cover !important;
  width: 100% !important;
}
/* Product card cursor and focus */
.product-card {
  cursor: pointer;
}
.product-card:focus {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}
</style>
</head>
<body class="flex flex-col min-h-screen">
<!-- Header -->
<header class="shadow sticky top-0 z-50 flex items-center justify-between px-4 sm:px-6 lg:px-8 h-16 bg-[var(--primary-color)]" >
  <a aria-label="Rimba Collection Home" class="flex items-center select-none" href="#home" id="logoLink" >
    <div aria-hidden="true" class="flex items-center justify-center h-10 w-10 rounded-full bg-white text-[var(--primary-color)] font-bold text-xl select-none mr-3" >
      ES
    </div>
    <span class="text-white text-2xl font-semibold">ECI Creation Shop</span>
  </a>
  <nav aria-label="Primary Navigation" class="hidden md:flex space-x-8 font-semibold text-white" id="desktopNav" role="navigation" >
    <button aria-selected="true" class="tab-button focus:outline-none focus:ring-2 focus:ring-white rounded" data-tab="home" role="tab" tabindex="0" type="button" >
      Home
    </button>
    <button aria-selected="false" class="tab-button focus:outline-none focus:ring-2 focus:ring-white rounded" data-tab="Men" role="tab" tabindex="-1" type="button" >
      Men
    </button>
    <button aria-selected="false" class="tab-button focus:outline-none focus:ring-2 focus:ring-white rounded" data-tab="Women" role="tab" tabindex="-1" type="button" >
      Women
    </button>
    <!-- <button aria-selected="false" class="tab-button focus:outline-none focus:ring-2 focus:ring-white rounded" data-tab="Accessories" role="tab" tabindex="-1" type="button" >
      Accessories
    </button> -->
    <button aria-label="Open shopping cart" class="flex items-center space-x-1 hover:underline focus:underline focus:outline-none" id="openCartBtn" role="button" tabindex="0" type="button" >
      <i class="fas fa-shopping-cart"></i>
      <span>Cart</span>
    </button>
    <div class="relative group">
      <button id="userMenuButton" aria-haspopup="true" aria-expanded="false" class="flex items-center space-x-1 hover:underline focus:underline focus:outline-none" type="button" >
        <i class="fas fa-user-circle fa-lg"></i>
        <span>User</span>
        <i class="fas fa-caret-down"></i>
      </button>
      <div id="userMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50" >
        <a href="#" id="loginLink" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer" >Login</a >
        <a href="#" id="signupLink" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer" >Sign Up</a >
        <a href="#" id="adminLoginLink" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer" >Admin</a >
        <button id="logoutBtn" class="hidden w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer" > Logout </button>
      </div>
    </div>
  </nav>
  <div class="md:hidden">
    <button aria-label="Toggle menu" class="text-white focus:outline-none focus:ring-2 focus:ring-white rounded" id="mobile-menu-button" type="button" >
      <i class="fas fa-bars fa-lg"></i>
    </button>
  </div>
</header>
<nav aria-label="Mobile Navigation" class="hidden md:hidden bg-[var(--primary-color)] border-t border-[rgba(30,64,175,0.3)]" id="mobile-menu" role="navigation" >
  <button aria-selected="true" class="block w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none tab-button" data-tab="home" role="tab" tabindex="0" type="button" >
    Home
  </button>
  <button aria-selected="false" class="block w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none tab-button" data-tab="Men" role="tab" tabindex="-1" type="button" >
    Men
  </button>
  <button aria-selected="false" class="block w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none tab-button" data-tab="Women" role="tab" tabindex="-1" type="button" >
    Women
  </button>
  <button aria-selected="false" class="block w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none tab-button" data-tab="Accessories" role="tab" tabindex="-1" type="button" >
    Accessories
  </button>
  <button class="w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none flex items-center space-x-1" id="mobileOpenCartBtn" type="button" >
    <i class="fas fa-shopping-cart"></i>
    <span>Cart</span>
  </button>
  <div class="border-t border-[rgba(255,255,255,0.2)]">
    <button id="mobileLoginBtn" class="w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none" type="button" >
      Login
    </button>
    <button id="mobileSignupBtn" class="w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none" type="button" >
      Sign Up
    </button>
    <button id="mobileAdminLoginBtn" class="w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none" type="button" >
      Admin
    </button>
    <button id="mobileLogoutBtn" class="hidden w-full text-left px-4 py-3 text-white hover:bg-[#1e3a8a] focus:bg-[#1e3a8a] focus:outline-none" type="button" >
      Logout
    </button>
  </div>
</nav>
<!-- Hero Section -->
<section aria-label="Hero section with featured collections and call to action" class="relative bg-gradient-to-r from-indigo-700 via-indigo-800 to-indigo-900 text-white py-20 px-6 sm:px-12 lg:px-20" >
  <div class="max-w-7xl mx-auto flex flex-col lg:flex-row items-center gap-12">
    <div class="lg:w-1/2 space-y-6">
      <h1 class="text-4xl sm:text-5xl font-extrabold leading-tight"> Discover Your Style with <span class="text-emerald-400">ECI Creation Shop</span> </h1>
      <p class="text-lg sm:text-xl text-indigo-200 max-w-xl"> Explore the latest trends in men's, women's, and accessories fashion. Quality, comfort, and style all in one place. </p>
      <div class="flex flex-wrap gap-4">
        <a class="inline-block bg-emerald-500 hover:bg-emerald-600 focus:ring-4 focus:ring-emerald-300 text-white font-semibold py-3 px-6 rounded-lg transition" href="#productsGrid" >Shop Now</a >
        <a class="inline-block border border-white hover:border-emerald-400 focus:ring-4 focus:ring-emerald-300 text-white font-semibold py-3 px-6 rounded-lg transition" href="#contact" >Contact Us</a >
      </div>
    </div>
    <div style="height: 450px;" class="lg:w-1/2 grid grid-cols-2 gap-6">
      <div class="overflow-hidden rounded-lg shadow-lg">
        <img alt="Men's fashion model wearing a stylish indigo outfit with modern accessories, standing confidently in urban setting" class="w-full h-full object-cover" height="600" loading="lazy" src="cloth3.jpg" width="600" />
      </div>
      <div class="overflow-hidden rounded-lg shadow-lg">
        <img alt="Women's fashion model in an elegant emerald green dress posing gracefully in a natural outdoor environment" class="w-full h-full object-cover" height="600" loading="lazy" src="unnamed.jpg" width="600" />
      </div>
      <div class="overflow-hidden rounded-lg shadow-lg">
        <img alt="Display of high-quality leather wallet and stylish baseball cap on a wooden table with soft natural lighting" class="w-full h-full object-cover" height="600" loading="lazy" src="unnamed (1).jpg" width="600" />
      </div>
      <div class="overflow-hidden rounded-lg shadow-lg">
        <img alt="Casual outfit featuring trendy sneakers and blue denim jeans laid out on a rustic background" class="w-full h-full object-cover" height="600" loading="lazy" src="anic.png" width="600" />
      </div>
    </div>
  </div>
  <svg aria-hidden="true" class="absolute bottom-0 left-0 w-full h-24 text-indigo-900" fill="currentColor" preserveAspectRatio="none" viewBox="0 0 1440 320" >
    <path d="M0,224L48,197.3C96,171,192,117,288,117.3C384,117,480,171,576,197.3C672,224,768,224,864,197.3C960,171,1056,117,1152,117.3C1248,117,1344,171,1392,197.3L1440,224L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z" fill-opacity="0.3" ></path>
  </svg>
</section>
<!-- Main Content -->
<main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="home" tabindex="-1" >
  <!-- Search and Filters -->
  <section aria-label="Search and filter products" class="mb-8">
    <div class="flex flex-col md:flex-row md:items-center md:space-x-6 space-y-4 md:space-y-0" >
      <input aria-label="Search products" autocomplete="off" class="flex-grow border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color" id="searchInput" placeholder="Search products..." spellcheck="false" style="--tw-ring-color: var(--primary-color)" type="text" />
      <select aria-label="Filter by category" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color" id="categoryFilter" style="--tw-ring-color: var(--primary-color)" >
        <option value="">All Categories</option>
        <option value="Men">Men</option>
        <option value="Women">Women</option>
        <!-- <option value="Accessories">Accessories</option> -->
      </select>
      <select aria-label="Filter by size" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color" id="sizeFilter" style="--tw-ring-color: var(--primary-color)" >
        <option value="">All Sizes</option>
        <option value="XS">XS</option>
        <option value="S">S</option>
        <option value="M">M</option>
        <option value="L">L</option>
        <option value="XL">XL</option>
      </select>
      <select aria-label="Filter by price" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color" id="priceFilter" style="--tw-ring-color: var(--primary-color)" >
        <option value="">All Prices</option>
        <option value="0-20">Under $20</option>
        <option value="20-50">$20 - $50</option>
        <option value="50-100">$50 - $100</option>
        <option value="100-9999">Above $100</option>
      </select>
    </div>
  </section>
  <!-- Products Grid -->
  <section aria-label="Product listings">
    <div aria-atomic="true" aria-live="polite" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6" id="productsGrid" >
      <!-- Products injected by JS -->
    </div>
  </section>
</main>
<!-- Product Detail Modal -->
<div aria-describedby="productDetailDescription" aria-labelledby="productDetailTitle" aria-modal="true" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-60 popupContainer" id="productDetailModal" role="dialog" >
  <div class="bg-white rounded-lg max-w-5xl w-full max-h-full overflow-y-auto shadow-lg p-6 relative flex flex-col md:flex-row gap-6" >
    <button aria-label="Close product details" class="absolute top-4 right-4 text-gray-600 hover:text-primary-color modal_close focus:outline-none" id="closeProductDetail" type="button" >
      <i class="fas fa-times fa-lg"></i>
    </button>
    <div aria-label="Product image container" class="md:w-1/2 flex justify-center items-center thumb" tabindex="0" >
      <img alt="" class="w-full max-w-md rounded product-image" id="detailImage" loading="lazy" src="" />
    </div>
    <div class="md:w-1/2 flex flex-col justify-between">
      <div>
        <h2 class="text-2xl font-semibold text-gray-800 mb-4" id="productDetailTitle"></h2>
        <p class="text-gray-700 mb-4" id="productDetailDescription"></p>
        <p class="text-xl font-bold mb-6" id="productDetailPrice"></p>
        <div class="mb-6" id="sizeOptions">
          <label class="block font-semibold mb-2" for="sizeSelect">Select Size:</label>
          <select aria-label="Select product size" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-primary-color" id="sizeSelect" ></select>
        </div>
        <div class="mb-6">
          <label class="block font-semibold mb-2" for="quantityInput">Quantity:</label>
          <input aria-label="Select quantity" class="border border-gray-300 rounded-md px-3 py-2 w-24 focus:outline-none focus:ring-2 focus:ring-primary-color" id="quantityInput" min="1" type="number" value="1" />
        </div>
        <button aria-label="Add product to cart" class="text-white py-2 px-4 rounded-md font-semibold hover:bg-link-hover-color transition w-full mb-4" id="addToCartDetailBtn" style="background-color: var(--primary-color);" type="button" >
          Add to Cart
        </button>
        <button aria-label="Chat for bargaining" class="chat-btn w-full text-primary-600 border border-primary-600 hover:bg-primary-100 rounded-md py-2 font-semibold transition" id="chatBargainBtn" type="button" >
          Chat for Bargaining
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Shopping Cart Sidebar -->
<aside aria-label="Shopping cart" class="fixed top-0 right-0 h-full w-80 bg-white shadow-lg transform translate-x-full transition-transform duration-300 z-50 flex flex-col" id="cartSidebar" tabindex="-1" >
  <div class="flex items-center justify-between p-4 border-b border-gray-200">
    <h2 class="text-lg font-semibold">Shopping Cart</h2>
    <button aria-label="Close cart" class="text-gray-600 hover:text-primary-color focus:outline-none" id="closeCartBtn" type="button" >
      <i class="fas fa-times fa-lg"></i>
    </button>
  </div>
  <div aria-live="polite" aria-relevant="additions removals" class="flex-grow overflow-y-auto p-4 space-y-4" id="cartItems" tabindex="0" >
    <!-- Cart items injected here -->
  </div>
  <div class="p-4 border-t border-gray-200">
    <div class="flex justify-between font-semibold text-gray-700 mb-4">
      <span>Total:</span>
      <span id="cartTotal">$0.00</span>
    </div>
    <button aria-label="Proceed to checkout" class="w-full text-white py-2 rounded-md hover:bg-link-hover-color transition" id="checkoutBtn" style="background-color: var(--primary-color);" type="button" >
      Proceed to Checkout
    </button>
  </div>
</aside>
<!-- Overlay for Cart -->
<div class="fixed inset-0 bg-black bg-opacity-40 hidden z-40" id="cartOverlay" tabindex="-1" ></div>
<!-- Checkout Modal -->
<div aria-labelledby="checkoutTitle" aria-modal="true" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-60 popupContainer" id="checkoutModal" role="dialog" >
  <div class="bg-white rounded-lg max-w-lg w-full max-h-full overflow-y-auto shadow-lg p-6 relative" >
    <button aria-label="Close checkout" class="absolute top-4 right-4 text-gray-600 hover:text-primary-color modal_close focus:outline-none" id="closeCheckoutBtn" type="button" >
      <i class="fas fa-times fa-lg"></i>
    </button>
    <h3 class="text-2xl font-semibold mb-6" id="checkoutTitle">Checkout</h3>
    <form class="space-y-6" id="checkoutForm" novalidate>
      <div>
        <label class="block text-gray-700 font-medium mb-1" for="name" >Full Name</label >
        <input class="w-full border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color" id="name" name="name" required type="text" autocomplete="name" />
      </div>
      <div>
        <label class="block text-gray-700 font-medium mb-1" for="address" >Shipping Address</label >
        <textarea class="w-full border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary-color resize-none" id="address" name="address" required rows="3" autocomplete="street-address" ></textarea>
      </div>
      <div>
        <h4 class="text-lg font-semibold text-gray-800 mb-2">Order Summary</h4>
        <ul aria-live="polite" aria-relevant="additions removals" class="max-h-40 overflow-y-auto border border-gray-200 rounded-md p-3 space-y-2 text-gray-700 text-sm" id="checkoutSummary" >
          <!-- Summary items injected here -->
        </ul>
        <div class="flex justify-between font-semibold text-gray-900 mt-3 text-lg">
          <span>Total:</span>
          <span id="checkoutTotal">$0.00</span>
        </div>
      </div>
      <button class="w-full text-white py-3 rounded-md hover:bg-link-hover-color transition font-semibold" style="background-color: var(--primary-color);" type="submit" >
        Place Order
      </button>
    </form>
  </div>
</div>
<!-- Chatbot -->
<div aria-describedby="chatbotMessages" aria-labelledby="chatbotHeader" aria-modal="true" id="chatbot" role="dialog" class="fixed bottom-20 right-5 w-80 max-h-[400px] bg-white rounded-xl shadow-lg flex flex-col overflow-hidden z-50 hidden font-sans" >
  <div id="chatbotHeader" class="bg-[var(--primary-color)] text-white p-3 font-semibold flex justify-between items-center select-none" >
    Bargain Chat
    <button aria-label="Close chat" class="text-white hover:text-gray-300 focus:outline-none" id="closeChatbotBtn" type="button" >
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div id="chatbotMessages" class="flex-grow p-4 overflow-y-auto text-sm text-[var(--text-primary)]" tabindex="0" aria-live="polite" aria-atomic="false" ></div>
  <div id="chatbotInputContainer" class="border-t border-gray-300 p-3 flex gap-2" >
    <input aria-label="Chat input" autocomplete="off" id="chatbotInput" placeholder="Type your message..." spellcheck="false" type="text" class="flex-grow border border-gray-300 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]" />
    <button aria-label="Send message" id="chatbotSendBtn" type="button" class="bg-[var(--primary-color)] text-white rounded-full px-4 py-2 font-semibold hover:bg-[var(--link-hover-color)] focus:outline-none transition" >
      Send
    </button>
  </div>
</div>
<!-- Login/Signup/Admin Modal -->
<div aria-modal="true" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-70 popupContainer" id="authModal" role="dialog" aria-labelledby="authModalTitle" aria-describedby="authModalDesc" >
  <div class="bg-white rounded-lg max-w-md w-full p-6 relative shadow-lg" >
    <button aria-label="Close authentication modal" class="absolute top-4 right-4 text-gray-600 hover:text-[var(--primary-color)] modal_close focus:outline-none" id="closeAuthModal" type="button" >
      <i class="fas fa-times fa-lg"></i>
    </button>
    <h2 id="authModalTitle" class="text-2xl font-semibold mb-4 text-center"></h2>
    <form id="authForm" class="space-y-4" novalidate>
      <div id="authNameGroup" class="hidden">
        <label for="authName" class="block text-gray-700 font-medium mb-1" >Full Name</label >
        <input type="text" id="authName" name="authName" autocomplete="name" class="w-full border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]" />
      </div>
      <div>
        <label for="authEmail" class="block text-gray-700 font-medium mb-1" >Email</label >
        <input type="email" id="authEmail" name="authEmail" autocomplete="email" required class="w-full border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]" />
      </div>
      <div>
        <label for="authPassword" class="block text-gray-700 font-medium mb-1" >Password</label >
        <input type="password" id="authPassword" name="authPassword" required class="w-full border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)]" />
      </div>
      <button type="submit" class="w-full bg-[var(--primary-color)] text-white py-2 rounded-md font-semibold hover:bg-[var(--link-hover-color)] focus:outline-none transition" >
        Submit
      </button>
    </form>
    <p id="authSwitchText" class="mt-4 text-center text-gray-600 cursor-pointer select-none"></p>
  </div>
</div>
<!-- Footer -->
<footer>
  <div class="footer-container">
    <div class="footer-section">
      <div class="footer-logo">
        <div aria-hidden="true" class="flex items-center justify-center h-10 w-10 rounded-full bg-white text-[var(--primary-color)] font-bold text-xl select-none mr-3" >
          RC
        </div>
        <span>ECI Creation Shop</span>
      </div>
      <p>© 2024 ECI Creation Shop. All rights reserved.</p>
      <p> Developed by <a href="https://github.com/ElieMpuhwezimana" rel="noopener noreferrer" target="_blank" >Elie Mpuhwezimana</a > </p>
    </div>
    <div class="footer-section">
      <h3 class="text-lg font-semibold mb-3">Contact Us</h3>
      <p>Email: <a href="mailto:contact@rimbacollection.com">contact@rimbacollection.com</a></p>
      <p>Phone: <a href="tel:+250788123456">+250 788 123 456</a></p>
      <p>Address: Kigali, Rwanda</p>
    </div>
    <div class="footer-section" id="contact">
      <h3 class="text-lg font-semibold mb-3">Send us a message</h3>
      <form id="footerContactForm" novalidate>
        <input aria-label="Your name" id="contactName" name="contactName" placeholder="Your Name" required type="text" autocomplete="name" />
        <input aria-label="Your email" id="contactEmail" name="contactEmail" placeholder="Your Email" required type="email" autocomplete="email" />
        <textarea aria-label="Your message" id="contactMessage" name="contactMessage" placeholder="Your Message" required rows="4" ></textarea>
        <button type="submit">Send Message</button>
      </form>
    </div>
  </div>
</footer>
<script>
const products = [
  { id: 1, name: "Men's Classic White Shirt", category: "Men", size: ["S", "M", "L", "XL"], price: 25.99, image: "unnamed (1).jpg", description: "A timeless white shirt for men, perfect for formal and casual occasions." },
  { id: 2, name: "Women's Red Summer Dress", category: "Women", size: ["XS", "S", "M", "L"], price: 45.5, image: "unnamed (2).jpg", description: "Light and breezy red summer dress for women, ideal for warm weather." },
  { id: 4, name: "Men's Blue Denim Jeans", category: "Men", size: ["M", "L", "XL"], price: 39.99, image: "unnamed (3).jpg", description: "Comfortable and stylish blue denim jeans for men." },
  { id: 5, name: "Women's Black Leather Jacket", category: "Women", size: ["S", "M", "L"], price: 89.99, image: "unnamed.jpg", description: "Elegant black leather jacket for women, perfect for chilly days." },
  { id: 7, name: "Men's Formal Black Shoes", category: "Men", size: ["M", "L", "XL"], price: 59.99, image: "cloth1.jpg", description: "Classic black formal shoes for men, perfect for office and events." },
  { id: 8, name: "Women's Casual Sneakers", category: "Women", size: ["S", "M", "L"], price: 49.99, image: "cloth2.jpg", description: "Comfortable and stylish sneakers for everyday wear." },
  { id: 10, name: "Men's Sports Jacket", category: "Men", size: ["S", "M", "L", "XL"], price: 75.0, image: "cloth3.jpg", description: "Lightweight sports jacket for men, suitable for outdoor activities." },
  { id: 11, name: "Women's Evening Gown", category: "Women", size: ["S", "M", "L"], price: 120.0, image: "cloth4.jpg", description: "Elegant evening gown for special occasions." },
  { id: 13, name: "Men's Casual T-Shirt", category: "Men", size: ["XS", "S", "M", "L", "XL"], price: 18.0, image: "good.jpg", description: "Comfortable casual t-shirt for men, available in multiple colors." },
  { id: 14, name: "Women's Yoga Pants", category: "Women", size: ["S", "M", "L"], price: 29.99, image: "anic.png", description: "Stretchy and comfortable yoga pants for women." },
];

let cart = {};
let currentUser = null;
const productsGrid = document.getElementById("productsGrid");
const searchInput = document.getElementById("searchInput");
const categoryFilter = document.getElementById("categoryFilter");
const sizeFilter = document.getElementById("sizeFilter");
const priceFilter = document.getElementById("priceFilter");
const cartSidebar = document.getElementById("cartSidebar");
const cartOverlay = document.getElementById("cartOverlay");
const cartItemsContainer = document.getElementById("cartItems");
const cartTotalEl = document.getElementById("cartTotal");
const checkoutBtn = document.getElementById("checkoutBtn");
const closeCartBtn = document.getElementById("closeCartBtn");
const checkoutModal = document.getElementById("checkoutModal");
const closeCheckoutBtn = document.getElementById("closeCheckoutBtn");
const checkoutForm = document.getElementById("checkoutForm");
const checkoutSummary = document.getElementById("checkoutSummary");
const checkoutTotal = document.getElementById("checkoutTotal");
const mobileMenuButton = document.getElementById("mobile-menu-button");
const mobileMenu = document.getElementById("mobile-menu");
const openCartBtn = document.getElementById("openCartBtn");
const mobileOpenCartBtn = document.getElementById("mobileOpenCartBtn");
const productDetailModal = document.getElementById("productDetailModal");
const closeProductDetail = document.getElementById("closeProductDetail");
const detailImage = document.getElementById("detailImage");
const productDetailTitle = document.getElementById("productDetailTitle");
const productDetailDescription = document.getElementById("productDetailDescription");
const productDetailPrice = document.getElementById("productDetailPrice");
const sizeOptions = document.getElementById("sizeOptions");
const sizeSelect = document.getElementById("sizeSelect");
const quantityInput = document.getElementById("quantityInput");
const addToCartDetailBtn = document.getElementById("addToCartDetailBtn");
const chatBargainBtn = document.getElementById("chatBargainBtn");
const chatbot = document.getElementById("chatbot");
const chatbotMessages = document.getElementById("chatbotMessages");
const chatbotInput = document.getElementById("chatbotInput");
const chatbotSendBtn = document.getElementById("chatbotSendBtn");
const closeChatbotBtn = document.getElementById("closeChatbotBtn");
const authModal = document.getElementById("authModal");
const closeAuthModal = document.getElementById("closeAuthModal");
const authModalTitle = document.getElementById("authModalTitle");
const authForm = document.getElementById("authForm");
const authNameGroup = document.getElementById("authNameGroup");
const authNameInput = document.getElementById("authName");
const authEmailInput = document.getElementById("authEmail");
const authPasswordInput = document.getElementById("authPassword");
const authSwitchText = document.getElementById("authSwitchText");
const userMenuButton = document.getElementById("userMenuButton");
const userMenu = document.getElementById("userMenu");
const loginLink = document.getElementById("loginLink");
const signupLink = document.getElementById("signupLink");
const adminLoginLink = document.getElementById("adminLoginLink");
const logoutBtn = document.getElementById("logoutBtn");
const mobileLoginBtn = document.getElementById("mobileLoginBtn");
const mobileSignupBtn = document.getElementById("mobileSignupBtn");
const mobileAdminLoginBtn = document.getElementById("mobileAdminLoginBtn");
const mobileLogoutBtn = document.getElementById("mobileLogoutBtn");
let currentProduct = null;
const ADMIN_EMAIL = "mpuwezimanaelie@gmail.com";
const ADMIN_PASSWORD_KEY = "rimbaAdminPassword";
if (!localStorage.getItem(ADMIN_PASSWORD_KEY)) {
  localStorage.setItem(ADMIN_PASSWORD_KEY, "admin123");
}
function saveUserSession() {
  if (currentUser) {
    localStorage.setItem("rimbaUser", JSON.stringify(currentUser));
  } else {
    localStorage.removeItem("rimbaUser");
  }
  updateUserUI();
}
function loadUserSession() {
  const userData = localStorage.getItem("rimbaUser");
  if (userData) {
    currentUser = JSON.parse(userData);
  } else {
    currentUser = null;
  }
  updateUserUI();
}
function updateUserUI() {
  if (currentUser) {
    userMenuButton.setAttribute("aria-expanded", "false");
    loginLink.classList.add("hidden");
    signupLink.classList.add("hidden");
    adminLoginLink.classList.add("hidden");
    logoutBtn.classList.remove("hidden");
    mobileLoginBtn.classList.add("hidden");
    mobileSignupBtn.classList.add("hidden");
    mobileAdminLoginBtn.classList.add("hidden");
    mobileLogoutBtn.classList.remove("hidden");
    userMenuButton.querySelector("span").textContent = currentUser.name || currentUser.email;
  } else {
    loginLink.classList.remove("hidden");
    signupLink.classList.remove("hidden");
    adminLoginLink.classList.remove("hidden");
    logoutBtn.classList.add("hidden");
    mobileLoginBtn.classList.remove("hidden");
    mobileSignupBtn.classList.remove("hidden");
    mobileAdminLoginBtn.classList.remove("hidden");
    mobileLogoutBtn.classList.add("hidden");
    userMenuButton.querySelector("span").textContent = "User";
  }
}
userMenuButton.addEventListener("click", () => {
  const expanded = userMenuButton.getAttribute("aria-expanded") === "true";
  userMenuButton.setAttribute("aria-expanded", String(!expanded));
  userMenu.classList.toggle("hidden");
});
document.addEventListener("click", (e) => {
  if (!userMenu.contains(e.target) && !userMenuButton.contains(e.target)) {
    userMenu.classList.add("hidden");
    userMenuButton.setAttribute("aria-expanded", "false");
  }
});
function showAuthModal(mode) {
  authForm.reset();
  authModal.classList.remove("hidden");
  authModal.classList.add("popupContainer");
  authModal.setAttribute("aria-hidden", "false");
  authNameGroup.classList.add("hidden");
  authNameInput.required = false;
  authEmailInput.required = true;
  authPasswordInput.required = true;
  authPasswordInput.type = "password";
  if (mode === "login") {
    authModalTitle.textContent = "User Login";
    authSwitchText.innerHTML = 'Don\'t have an account? <span id="switchToSignup" class="text-blue-600 cursor-pointer hover:underline">Sign Up</span>';
  } else if (mode === "signup") {
    authModalTitle.textContent = "User Sign Up";
    authNameGroup.classList.remove("hidden");
    authNameInput.required = true;
    authSwitchText.innerHTML = 'Already have an account? <span id="switchToLogin" class="text-blue-600 cursor-pointer hover:underline">Login</span>';
  } else if (mode === "admin") {
    authModalTitle.textContent = "Admin Login";
    authSwitchText.innerHTML = 'Back to <span id="switchToLoginFromAdmin" class="text-blue-600 cursor-pointer hover:underline">User Login</span>';
  }
  setTimeout(() => {
    const switchToSignup = document.getElementById("switchToSignup");
    const switchToLogin = document.getElementById("switchToLogin");
    const switchToLoginFromAdmin = document.getElementById("switchToLoginFromAdmin");
    if (switchToSignup) {
      switchToSignup.onclick = () => showAuthModal("signup");
    }
    if (switchToLogin) {
      switchToLogin.onclick = () => showAuthModal("login");
    }
    if (switchToLoginFromAdmin) {
      switchToLoginFromAdmin.onclick = () => showAuthModal("login");
    }
  }, 0);
  authEmailInput.focus();
  authForm.dataset.mode = mode;
}
closeAuthModal.addEventListener("click", () => {
  authModal.classList.add("hidden");
  authModal.classList.remove("popupContainer");
  authModal.setAttribute("aria-hidden", "true");
});
authForm.addEventListener("submit", (e) => {
  e.preventDefault();
  const mode = authForm.dataset.mode;
  const email = authEmailInput.value.trim().toLowerCase();
  const password = authPasswordInput.value;
  const name = authNameInput.value.trim();
  if (!email || !password || (mode === "signup" && !name)) {
    alert("Please fill in all required fields.");
    return;
  }
  if (mode === "login") {
    if (email === ADMIN_EMAIL) {
      alert("Please use Admin login for admin accounts.");
      return;
    }
    currentUser = {
      role: "user",
      email,
      name: email.split("@")[0],
    };
    alert(`Welcome back, ${currentUser.name}!`);
  } else if (mode === "signup") {
    currentUser = {
      role: "user",
      email,
      name,
    };
    alert(`Account created! Welcome, ${name}!`);
  } else if (mode === "admin") {
    if (email === ADMIN_EMAIL) {
      const storedPassword = localStorage.getItem(ADMIN_PASSWORD_KEY);
      if (password === storedPassword) {
        currentUser = {
          role: "admin",
          email,
          name: "Admin"
        };
        alert("Admin login successful. Redirecting to admin dashboard...");
        window.location.href = "ok.html";
        return;
      } else {
        alert("Invalid admin credentials.");
        return;
      }
    } else {
      alert("Invalid admin credentials.");
      return;
    }
  }
  saveUserSession();
  authModal.classList.add("hidden");
  authModal.classList.remove("popupContainer");
  authModal.setAttribute("aria-hidden", "true");
});
function logout() {
  currentUser = null;
  saveUserSession();
  alert("You have been logged out.");
}
logoutBtn.addEventListener("click", () => {
  logout();
  userMenu.classList.add("hidden");
  userMenuButton.setAttribute("aria-expanded", "false");
});
mobileLogoutBtn.addEventListener("click", () => {
  logout();
  mobileMenu.classList.add("hidden");
});
loginLink.addEventListener("click", (e) => {
  e.preventDefault();
  showAuthModal("login");
  userMenu.classList.add("hidden");
  userMenuButton.setAttribute("aria-expanded", "false");
});
signupLink.addEventListener("click", (e) => {
  e.preventDefault();
  showAuthModal("signup");
  userMenu.classList.add("hidden");
  userMenuButton.setAttribute("aria-expanded", "false");
});
adminLoginLink.addEventListener("click", (e) => {
  e.preventDefault();
  showAuthModal("admin");
  userMenu.classList.add("hidden");
  userMenuButton.setAttribute("aria-expanded", "false");
});
mobileLoginBtn.addEventListener("click", () => {
  showAuthModal("login");
  mobileMenu.classList.add("hidden");
});
mobileSignupBtn.addEventListener("click", () => {
  showAuthModal("signup");
  mobileMenu.classList.add("hidden");
});
mobileAdminLoginBtn.addEventListener("click", () => {
  showAuthModal("admin");
  mobileMenu.classList.add("hidden");
});
function renderProducts(skipAnimation = false) {
  const searchTerm = searchInput.value.trim().toLowerCase();
  const category = categoryFilter.value;
  const size = sizeFilter.value;
  const priceRange = priceFilter.value;
  let filteredProducts = products.filter((product) => {
    if (!product.name.toLowerCase().includes(searchTerm)) return false;
    if (category && product.category !== category) return false;
    if (size) {
      if (!product.size.includes(size)) return false;
    }
    if (priceRange) {
      const [min, max] = priceRange.split("-").map(Number);
      if (product.price < min || product.price > max) return false;
    }
    return true;
  });
  const existingCards = Array.from(productsGrid.children);
  existingCards.forEach((card) => {
    card.classList.add("hidden");
  });
  setTimeout(() => {
    productsGrid.innerHTML = "";
    if (filteredProducts.length === 0) {
      productsGrid.innerHTML = `<p class="col-span-full text-center text-gray-500">No products found.</p>`;
      return;
    }
    filteredProducts.forEach((product) => {
      const productCard = document.createElement("div");
      productCard.className = "product-card bg-white rounded-lg shadow-md overflow-hidden flex flex-col cursor-pointer focus:outline-none focus:ring-4 focus:ring-primary-color";
      productCard.style.setProperty("--tw-ring-color", "var(--primary-color)");
      productCard.setAttribute("tabindex", "0");
      productCard.setAttribute("role", "button");
      productCard.setAttribute("aria-label", `View details for ${product.name}`);
      productCard.innerHTML = `
        <div class="thumb flex-grow">
          <img src="${product.image}" alt="Image of ${product.name}, category ${product.category}, priced at $${product.price.toFixed(2)}" class="w-full product-image" loading="lazy" />
        </div>
        <div class="p-4 flex flex-col flex-grow">
          <h3 class="text-lg font-semibold text-gray-800 mb-1">${product.name}</h3>
          <p class="text-gray-600 text-sm flex-grow">${product.description}</p>
          <div class="mt-3 flex items-center justify-between">
            <span class="font-bold text-lg" style="color: var(--primary-color);">$${product.price.toFixed(2)}</span>
            <button class="add-to-cart-btn px-3 py-1 rounded-md transition text-sm focus:outline-none focus:ring-4" data-id="${product.id}" aria-label="Add ${product.name} to cart" style="background-color: var(--primary-color); color: white;" type="button">Add to Cart</button>
          </div>
        </div>
      `;
      productCard.addEventListener("click", (e) => {
        if (e.target.closest(".add-to-cart-btn")) return;
        openProductDetail(product.id);
      });
      productCard.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          openProductDetail(product.id);
        }
      });
      productsGrid.appendChild(productCard);
      if (!skipAnimation) {
        productCard.style.opacity = 0;
        productCard.style.transform = "scale(0.8)";
        setTimeout(() => {
          productCard.style.transition = "opacity 0.3s ease, transform 0.3s ease";
          productCard.style.opacity = 1;
          productCard.style.transform = "scale(1)";
        }, 50);
      }
    });
    document.querySelectorAll(".add-to-cart-btn").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const id = parseInt(btn.getAttribute("data-id"));
        if (!currentUser) {
          showAuthModal("login");
          return;
        }
        addToCart(id);
      });
    });
  }, 300);
}
function openProductDetail(productId) {
  currentProduct = products.find((p) => p.id === productId);
  if (!currentProduct) return;
  detailImage.src = currentProduct.image;
  detailImage.alt = `Image of ${currentProduct.name}, category ${currentProduct.category}, priced at $${currentProduct.price.toFixed(2)}`;
  productDetailTitle.textContent = currentProduct.name;
  productDetailDescription.textContent = currentProduct.description;
  productDetailPrice.textContent = `$${currentProduct.price.toFixed(2)}`;
  productDetailPrice.style.color = "var(--primary-color)";
  if (currentProduct.size.length > 0) {
    sizeOptions.style.display = "block";
    sizeSelect.innerHTML = "";
    currentProduct.size.forEach((sz) => {
      const option = document.createElement("option");
      option.value = sz;
      option.textContent = sz;
      sizeSelect.appendChild(option);
    });
  } else {
    sizeOptions.style.display = "none";
  }
  quantityInput.value = 1;
  productDetailModal.classList.remove("hidden");
  productDetailModal.classList.add("popupContainer");
  productDetailModal.focus();
}
closeProductDetail.addEventListener("click", () => {
  productDetailModal.classList.add("hidden");
  productDetailModal.classList.remove("popupContainer");
  currentProduct = null;
  closeChatbot();
});
productDetailModal.addEventListener("click", (e) => {
  if (e.target === productDetailModal) {
    productDetailModal.classList.add("hidden");
    productDetailModal.classList.remove("popupContainer");
    currentProduct = null;
    closeChatbot();
  }
});
addToCartDetailBtn.addEventListener("click", () => {
  if (!currentProduct) return;
  if (!currentUser) {
    productDetailModal.classList.add("hidden");
    productDetailModal.classList.remove("popupContainer");
    showAuthModal("login");
    return;
  }
  const selectedSize = sizeSelect.value;
  if (currentProduct.size.length > 0 && !selectedSize) {
    alert("Please select a size.");
    return;
  }
  const quantity = parseInt(quantityInput.value);
  if (isNaN(quantity) || quantity < 1) {
    alert("Please enter a valid quantity.");
    return;
  }
  addToCart(currentProduct.id, selectedSize, quantity);
  productDetailModal.classList.add("hidden");
  productDetailModal.classList.remove("popupContainer");
  closeChatbot();
});
chatBargainBtn.addEventListener("click", () => {
  if (!currentUser) {
    productDetailModal.classList.add("hidden");
    productDetailModal.classList.remove("popupContainer");
    showAuthModal("login");
    return;
  }
  openChatbot();
});
function addToCart(productId, size = "", quantity = 1) {
  const key = size ? `${productId}-${size}` : `${productId}`;
  if (cart[key]) {
    cart[key].quantity += quantity;
  } else {
    const product = products.find((p) => p.id === productId);
    cart[key] = {
      ...product,
      quantity,
      selectedSize: size,
    };
  }
  saveCart();
  renderCart();
  openCart();
}
function removeFromCart(key) {
  delete cart[key];
  saveCart();
  renderCart();
}
function updateQuantity(key, quantity) {
  if (quantity < 1) return;
  if (cart[key]) {
    cart[key].quantity = quantity;
    saveCart();
    renderCart();
  }
}
function renderCart() {
  cartItemsContainer.innerHTML = "";
  const cartEntries = Object.entries(cart);
  if (cartEntries.length === 0) {
    cartItemsContainer.innerHTML = `<p class="text-center text-gray-500">Your cart is empty.</p>`;
    cartTotalEl.textContent = "$0.00";
    return;
  }
  let total = 0;
  cartEntries.forEach(([key, item]) => {
    total += item.price * item.quantity;
    const cartItem = document.createElement("div");
    cartItem.className = "flex items-center space-x-4";
    cartItem.innerHTML = `
      <img src="${item.image}" alt="Image of ${item.name} in cart" class="w-16 h-20 object-cover rounded" loading="lazy" />
      <div class="flex-grow">
        <h4 class="font-semibold text-gray-800">${item.name}${item.selectedSize ? ` (Size: ${item.selectedSize})` : ""}</h4>
        <p class="text-gray-600 text-sm">$${item.price.toFixed(2)}</p>
        <div class="mt-1 flex items-center space-x-2">
          <label for="qty-${key}" class="sr-only">Quantity</label>
          <input type="number" id="qty-${key}" min="1" value="${item.quantity}" class="w-16 border border-gray-300 rounded-md px-2 py-1 text-center focus:outline-none focus:ring-2" aria-label="Quantity for ${item.name}${item.selectedSize ? ` size ${item.selectedSize}` : ""}" style="--tw-ring-color: var(--primary-color)" />
          <button class="text-red-600 hover:text-red-800 focus:outline-none" aria-label="Remove ${item.name}${item.selectedSize ? ` size ${item.selectedSize}` : ""} from cart" type="button">
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>
    `;
    const qtyInput = cartItem.querySelector("input[type='number']");
    qtyInput.addEventListener("change", (e) => {
      const val = parseInt(e.target.value);
      if (isNaN(val) || val < 1) {
        e.target.value = item.quantity;
        return;
      }
      updateQuantity(key, val);
    });
    const removeBtn = cartItem.querySelector("button");
    removeBtn.addEventListener("click", () => {
      removeFromCart(key);
    });
    cartItemsContainer.appendChild(cartItem);
  });
  cartTotalEl.textContent = `$${total.toFixed(2)}`;
}
function saveCart() {
  localStorage.setItem("rimbaCart", JSON.stringify(cart));
}
function loadCart() {
  const savedCart = localStorage.getItem("rimbaCart");
  if (savedCart) {
    cart = JSON.parse(savedCart);
  }
}
function openCart() {
  cartSidebar.classList.remove("translate-x-full");
  cartOverlay.classList.remove("hidden");
  cartSidebar.setAttribute("aria-hidden", "false");
  cartSidebar.focus();
}
function closeCart() {
  cartSidebar.classList.add("translate-x-full");
  cartOverlay.classList.add("hidden");
  cartSidebar.setAttribute("aria-hidden", "true");
}
function openCheckout() {
  if (!currentUser) {
    alert("Please login to proceed to checkout.");
    showAuthModal("login");
    return;
  }
  if (Object.keys(cart).length === 0) {
    alert("Your cart is empty. Please add products before checkout.");
    return;
  }
  renderCheckoutSummary();
  checkoutModal.classList.remove("hidden");
  checkoutModal.classList.add("popupContainer");
  checkoutModal.querySelector("input, textarea").focus();
}
function closeCheckout() {
  checkoutModal.classList.add("hidden");
  checkoutModal.classList.remove("popupContainer");
  checkoutForm.reset();
}
function renderCheckoutSummary() {
  checkoutSummary.innerHTML = "";
  let total = 0;
  Object.values(cart).forEach((item) => {
    total += item.price * item.quantity;
    const li = document.createElement("li");
    li.textContent = `${item.name}${item.selectedSize ? ` (Size: ${item.selectedSize})` : ""} x${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`;
    checkoutSummary.appendChild(li);
  });
  checkoutTotal.textContent = `$${total.toFixed(2)}`;
}
checkoutForm.addEventListener("submit", (e) => {
  e.preventDefault();
  const name = checkoutForm.name.value.trim();
  const address = checkoutForm.address.value.trim();
  if (!name || !address) {
    alert("Please fill in all required fields.");
    return;
  }
  alert(`Thank you, ${name}! Your order has been placed and will be shipped to:\n${address}`);
  cart = {};
  saveCart();
  renderCart();
  closeCheckout();
  closeCart();
});
const footerContactForm = document.getElementById("footerContactForm");
footerContactForm.addEventListener("submit", (e) => {
  e.preventDefault();
  const name = footerContactForm.contactName.value.trim();
  const email = footerContactForm.contactEmail.value.trim();
  const message = footerContactForm.contactMessage.value.trim();
  if (!name || !email || !message) {
    alert("Please fill in all required fields.");
    return;
  }
  alert(`Thank you, ${name}! Your message has been received. We will contact you shortly.`);
  footerContactForm.reset();
});
searchInput.addEventListener("input", () => renderProducts());
categoryFilter.addEventListener("change", () => {
  renderProducts();
});
sizeFilter.addEventListener("change", renderProducts);
priceFilter.addEventListener("change", renderProducts);
checkoutBtn.addEventListener("click", openCheckout);
closeCartBtn.addEventListener("click", closeCart);
cartOverlay.addEventListener("click", closeCart);
closeCheckoutBtn.addEventListener("click", closeCheckout);
mobileMenuButton.addEventListener("click", () => {
  mobileMenu.classList.toggle("hidden");
});
openCartBtn.addEventListener("click", openCart);
mobileOpenCartBtn.addEventListener("click", () => {
  mobileMenu.classList.add("hidden");
  openCart();
});
document.querySelectorAll("nav a[href^='#']").forEach((link) => {
  link.addEventListener("click", function (e) {
    e.preventDefault();
    const targetId = this.getAttribute("href").slice(1);
    const target = document.getElementById(targetId);
    if (target) {
      target.scrollIntoView({ behavior: "smooth" });
      if (!mobileMenu.classList.contains("hidden")) {
        mobileMenu.classList.add("hidden");
      }
    }
  });
});
function openChatbot() {
  chatbot.style.display = "flex";
  chatbotInput.value = "";
  chatbotMessages.innerHTML = "";
  addBotMessage("Hello! How can I assist you with bargaining today?");
  chatbotInput.focus();
}
function closeChatbot() {
  chatbot.style.display = "none";
}
closeChatbotBtn.addEventListener("click", closeChatbot);
chatbotSendBtn.addEventListener("click", sendMessage);
chatbotInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    sendMessage();
  }
});
function addUserMessage(text) {
  const div = document.createElement("div");
  div.className = "chatbot-message user";
  div.textContent = text;
  chatbotMessages.appendChild(div);
  chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
}
function addBotMessage(text) {
  const div = document.createElement("div");
  div.className = "chatbot-message bot";
  div.textContent = text;
  chatbotMessages.appendChild(div);
  chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
}
function sendMessage() {
  const text = chatbotInput.value.trim();
  if (!text) return;
  addUserMessage(text);
  chatbotInput.value = "";
  setTimeout(() => {
    if (text.toLowerCase().includes("price")) {
      addBotMessage("I can help you with price negotiations. What product are you interested in?");
    } else if (text.toLowerCase().includes("hello") || text.toLowerCase().includes("hi")) {
      addBotMessage("Hello! Feel free to ask about any product or bargaining options.");
    } else if (text.toLowerCase().includes("thank")) {
      addBotMessage("You're welcome! Let me know if you need anything else.");
    } else {
      addBotMessage("Thanks for your message! Our team will get back to you shortly.");
    }
  }, 1000);
}
loadCart();
loadUserSession();
renderProducts();
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    if (!productDetailModal.classList.contains("hidden")) {
      productDetailModal.classList.add("hidden");
      productDetailModal.classList.remove("popupContainer");
      currentProduct = null;
      closeChatbot();
    }
    if (!checkoutModal.classList.contains("hidden")) {
      checkoutModal.classList.add("hidden");
      checkoutModal.classList.remove("popupContainer");
    }
    if (!cartSidebar.classList.contains("translate-x-full")) {
      closeCart();
    }
    if (!chatbot.classList.contains("hidden")) {
      closeChatbot();
    }
    if (!authModal.classList.contains("hidden")) {
      authModal.classList.add("hidden");
      authModal.classList.remove("popupContainer");
      authModal.setAttribute("aria-hidden", "true");
    }
  }
});
</script>
</body>
</html>